# Piezo-mediated mechanosensation contributes to stabilizing copulation posture and reproductive success in Drosophila males


### Figure 2C, D

- DeepLabCut model for tracking the flies position : male_copulation_posture_model
- Calculating the male copulation posture : reshape_dataset.ipynb
- Plotting and statistics analysis : piezo_ratio_and_bunsan.R

### Figure 2E

- DeepLabCut model for tracking the flies position : male_copulation_posture_model
- Calculating the male copulation posture and plotting : reshape_dataset.ipynb

### Figure 3A
- Plotting and statistics analysis : cop_ratio.R

### Figure 3B
- Plotting and statistics analysis : cop_ratio.R

### Figure 3C
- Plotting and statistics analysis : cop_ratio.R

### Figure 5C, H
- Plotting and statistics analysis : copulation_opt.R

### Figure 5F
- DeepLabCut model for tracking the flies position : male_copulation_posture_movement_model
- Calculating the male copulation position : laser_opt_analysis.ipynb
- Plotting and statistics analysis : laser_analysis.R

### Figure 5G
- DeepLabCut model for tracking the flies position : male_copulation_posture_movement_model
- Calculating the male copulation position : laser_opt_analysis.ipynb
- Plotting and statistics analysis : laser_analysis.R

### Figure S2A-K
- DeepLabCut model for tracking the flies position : male_copulation_posture_model
- Calculating the male copulation posture : reshape_dataset_20-30.ipynb
- Plotting and statistics : ratio_graph_drawing.R


### Figure S3A
- Plotting and statistics : kick_copulation_analysis.R

### Figure S3B
- Plotting and statistics : genital_touch_count_analysis.R

### Figure S4A
- Plotting and statistics : activity_analysis.R

### Figure S4B
- Plotting and statistics : fly_scale_analysis.R

### Figure S5
- Plotting and statistics : copulation_mixing_assay.R

### Figure S7A, B
- Plotting and statistics : copulation_opt_head_grooming.R

### Figure S9B
- Calculating the male copulation posture : laser_map.ipynb
- Plotting and statistics :laser_strength_analysis.R

### Figure S14B
- DeepLabCut model for tracking the flies position : male_copulation_posture_model
- Calculating the DLC time : reshape_dataset.ipynb
- Plotting and statistics : piezo_ratio_and_bunsan.R

### Closed-optogenetic system for optogenetic assays with LED
- DeepLabCut model : copulation_detection_model_for_LED
- Bonsai script : copulation_detect_LED.bonsai
- Arduino script : Create_PWMstimu_bonsai_to_arduino_LED.ino, StandardFirmata.ino

### Closed-optogenetic system for optogenetic assays with a laser
- DeepLabCut model : copulation_detection_model_for_laser
- Bonsai script : copulation_detect_laser.bonsai
- Arduino script : Create_PWMstimu_bonsai_to_arduino_laser.ino, StandardFirmata.ino

